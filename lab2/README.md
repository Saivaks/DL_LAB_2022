# DL_LAB_2022

В данной работе нам необходимо было на датасете youtube-videos-dataset использовать модель bert для классификации заголовком по 4 категориям. Также нам необходимо было исследовать качество обучения различных комбинаций слоев модели. 

# Архитектура Bert
BERT — это модель для предварительного обучения, обученная на Books Corpus с 800 млн слов и английской Википедии с 2500 млн слов. Эта модель является двунаправленной нейронной сетью-кодировщиком что означает что она использует левый и правый контекст слов. Базовая модель берта состоит из 12 слоев. 

![image](https://user-images.githubusercontent.com/58116790/209441945-493c2f8c-e357-4983-9ee0-01af3cd25b1a.png)

![image](https://user-images.githubusercontent.com/58116790/209441763-ade1dda7-3225-4cef-b947-659ed38cfd92.png)

# Ход работы

В рамках этой лабораторной работы мы будет выполнять тонкую настроку модели Bert то есть дообучать ее. Крайне важно провести предварительную очистку данных поскольку данная модель сильно зависима от того сколько мусора будет содержаться в предложениях. Чтобы выявить основные проблемы мы рассмотрели первые 500 строк датафрейма. Были выявлены следующие проблемы:
1) Описание может состоять из нескольких предложений которые отделены символом |. Это является проблемой поскольку модель Bert может принимать максимум 2 предложения 
2) Присутствие в тексте эмодзи, смайлов и тд
3) Присутствие слов на других языках
4) Специальные символы
5) Цифры, даты и тд
6) Слова выпадающие из контекста (то что в скобках)

Проблемы с пункта 2-6 мы решили с помощью регулярных выражений. Однако проблема 1 так просто не решается. У нас было несколько гипотез для ее решения:
1) Оставить как есть, удалить символы |
2) Оставить 2 предложений. Остальные удалить 
3) Оставить 1 наибольшее предложение. Остальные удалить 
Мы протестировали эти варианты. Наилучшим оказался вариант 3 поэтому его и будем использовать в дальнейшем.
Следуюим нашим шагом является дообучение bert. Для этого мы разбивали весь датасет на две части где 80% использовалось для дообучения и 20% для валидации. 
Мы делали это на различных комбинациях слоев: первой половие, второй половине, все, только последний линейные и тд. 

# Результаты 
Обучение всей модели:

![image](https://user-images.githubusercontent.com/58116790/209447477-e8f5a275-faab-4951-aa27-e570abfc0ff0.png)

Обучение только линейного слоя:

![image](https://user-images.githubusercontent.com/58116790/209447505-8a53fb5b-23d0-47fa-ad76-ec234776d2ec.png)

Обучение только четных слоев и последнего линейного:

Обчение только не четных слоев и последнего линейного:

Обчение только первой половины слоев и последнего линейного:

Обчение только второй половины слоев и последнего линейного:


